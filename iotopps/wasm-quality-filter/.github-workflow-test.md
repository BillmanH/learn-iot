# GitHub Actions Deployment Test

## Pipeline Integration Status

✅ **Added to Workflow**: `wasm-quality-filter` is now included in the GitHub Actions pipeline

### What's Configured:

1. **Manual Deployment**:
   - Go to GitHub Actions → "Deploy IoT Edge Application" 
   - Select `wasm-quality-filter` from dropdown
   - Choose environment (development/production)
   - Run workflow

2. **Automatic Deployment**:
   - Push changes to `dev` branch under `iotopps/wasm-quality-filter/`
   - Pipeline automatically detects changes and deploys

3. **Build Enhancements**:
   - Rust toolchain with `wasm32-wasi` target
   - Cargo dependency caching for faster builds
   - Multi-stage Docker build support

### Expected Workflow Steps:

1. **Change Detection**: Pipeline detects changes in `iotopps/wasm-quality-filter/`
2. **Rust Setup**: Installs Rust toolchain with WASM target
3. **Dependency Cache**: Caches Cargo dependencies
4. **Docker Build**: Multi-stage build (WASM + MQTT processor)
5. **Registry Push**: Pushes to configured registry (Docker Hub or ACR)
6. **K8s Deploy**: Deploys to Azure IoT Operations cluster
7. **Health Check**: Verifies deployment and service readiness

### To Test:

1. Make a small change to any file in `iotopps/wasm-quality-filter/`
2. Commit and push to `dev` branch
3. Check Actions tab for automatic deployment

OR

1. Go to Actions → "Deploy IoT Edge Application"
2. Select `wasm-quality-filter`
3. Run workflow manually

### Registry Configuration:

The pipeline uses existing registry configuration:
- **Docker Hub**: Uses `DOCKER_USERNAME` and `DOCKER_PASSWORD` secrets
- **ACR**: Uses `ACR_USERNAME` and `ACR_PASSWORD` secrets
- Registry type controlled by `REGISTRY_TYPE` variable (`dockerhub` or `acr`)

### Monitoring:

After deployment, check:
- Pod status: `kubectl get pods -l app=wasm-quality-filter`
- Service status: `kubectl get service wasm-quality-filter-service`
- Logs: `kubectl logs -l app=wasm-quality-filter -f`
- Health endpoint: Available on port 8080 within cluster